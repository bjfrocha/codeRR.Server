<template>
    <div class="mt-4">
        <div class="row" v-if="showNoData">
            <div class="col-lg-12">
                <h1>No data</h1>
                <div>
                    Looks like you have not reported any errors yet. Report a few errors to see data on this page.
                </div>
                <h3>Sample data</h3>
                <img src="/images/DeploymentInsights/screenshot.png" style="border: 1px solid #333" />
            </div>
        </div>
        <div v-else>
            <div class="row">
                <div class="col">
                    <div>
                        <h3>Insights for the last 30 days</h3>
                    </div>

                    <div class="card-group mb-5 kpi-cards">

                        <div v-for="item in insights" class="insight" :title="item.indicator.Description">
                            <div class="title">
                                {{item.indicator.Title}}
                            </div>
                            <div class="value">
                                <span v-if="!item.indicator.ValueName || (item.indicator.IsValueNameApplicationName && applicationId)">
                                    {{item.indicator.Value|zeroIfEmpty}} {{item.indicator.ValueUnit}}
                                </span>
                                <span v-else>
                                    {{item.indicator.ValueName}}
                                </span>
                            </div>
                            <div v-if="item.indicator.PeriodValue && showMore" class="period-value">
                                <span v-if="!item.indicator.PeriodValueName">
                                    Quarter average: {{item.indicator.PeriodValue|zeroIfEmpty}} {{item.indicator.ValueUnit}}
                                </span>
                                <span v-else>
                                    Quarter: {{item.indicator.PeriodValueName}}
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row" v-if="charts.length > 0">
                <div class="col mb-2">
                    <div>
                        <h3>Yearly overview</h3>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-6" v-for="graph in charts">
                    <div class="card insight-chart w-100">
                        <div class="card-header">{{graph.title}}</div>
                        <div class="card-body">
                            <div class="description">
                                <em>
                                    {{graph.description}}
                                </em>
                            </div>
                            <div :data-name="graph.name" v-show="graph.visible">
                                <div class="position-relative coderr-chart">
                                    <div class="ct-chart" :id="'indicator-chart-' + graph.name">

                                    </div>
                                    <div class="legend">
                                        <div v-for="l in graph.legend" :class="l.className">
                                            <svg width="10" height="10">
                                                <rect width="10" height="10" class="ct-point" />
                                            </svg>
                                            {{l.name}}
                                        </div>
                                    </div>
                                    {{graph.Comment}}
                                </div>
                            </div>
                            <div v-for="alt in graph.alternatives" v-show="alt.visible">
                                <div class="position-relative coderr-chart">
                                    <div class="ct-chart" :id="'indicator-chart-' + alt.name">

                                    </div>
                                    <div class="legend">
                                        <div v-for="l in alt.legend" :class="l.className">
                                            <svg width="10" height="10">
                                                <rect width="10" height="10" class="ct-point" />
                                            </svg>
                                            {{l.name}}
                                        </div>
                                    </div>
                                    {{alt.Comment}}
                                </div>
                            </div>
                            <div v-show="graph.toplistVisible" class="pt-4">
                                <ol class="toplist">
                                    <li v-for="ti in graph.indicator.Toplist">{{ti.Title}} <em>({{ti.Value}} {{graph.indicator.ValueUnit||'incident(s)'}})</em></li>
                                </ol>
                            </div>
                        </div>
                        <div class="card-footer" v-if="graph.indicator.Toplist.length > 0 || graph.alternatives.length > 0">
                            <div class="row">
                                <div class="col">
                                    <button class="btn btn-dark btn-block" @click="showGraph(graph, graph)">Default</button>
                                </div>
                                <div class="col" v-for="alt in graph.alternatives">
                                    <button class="btn btn-dark btn-block" @click="showGraph(alt, graph)">{{alt.title}}</button>
                                </div>
                                <div class="col" v-if="graph.indicator.Toplist.length > 0">
                                    <button class="btn btn-dark btn-block" @click="showTopList(graph)">Top list</button>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</template>

<!--<div v-if="indicator.Toplist.length > 0">
    <h4>Top list</h4>
    <ol>
        <li v-for="ti in indicator.Toplist">{{ti.Title}} ({{ti.Value}} {{selectedIndicator.ValueUnit||'incident(s)'}})</li>
    </ol>
</div>-->

<style src="chartist/dist/chartist.css"></style>
<style src="./home.css" />
<script src="./home.ts"></script>